{"version":3,"names":["BASE_URL","TIMEOUT","getToken","common_vendor","index","getStorageSync","setToken","token","setStorageSync","clearToken","removeStorageSync","isLoggedIn","request","options","arguments","length","undefined","Promise","resolve","reject","needLogin","navigateTo","url","Error","config","concat","method","timeout","header","_objectSpread2","contentType","data","success","res","__f__","handleResponse","fail","err","handleRequestError","statusCode","code","showToast","title","msg","icon","http","get","post","put","delete","_delete"],"sources":["request.js"],"sourcesContent":["// 网络请求工具类\n\n// API基础URL\n// const BASE_URL = 'http://192.168.249.197:8080';//杨家标热点\nconst BASE_URL = 'http://192.168.43.150:8080';//潘德林热点\n// const BASE_URL = 'http://139.9.179.161:8088';//服务器ip\n\n// 请求超时时间\nconst TIMEOUT = 30000;\n\n// 获取token\nfunction getToken() {\n  return uni.getStorageSync('token');\n}\n\n// 设置token\nfunction setToken(token) {\n  uni.setStorageSync('token', token);\n}\n\n// 清除token\nfunction clearToken() {\n  uni.removeStorageSync('token');\n}\n\n// 检查是否已登录\nfunction isLoggedIn() {\n  return !!getToken();\n}\n\n// 网络请求函数\nfunction request(options = {}) {\n  return new Promise((resolve, reject) => {\n    // 检查是否需要登录但未登录\n    if (options.needLogin && !isLoggedIn()) {\n      uni.navigateTo({ url: '/pages/login/login' });\n      reject(new Error('请先登录'));\n      return;\n    }\n\n    // 构建请求配置\n    const config = {\n      url: `${BASE_URL}${options.url}`,\n      method: options.method || 'GET',\n      timeout: options.timeout || TIMEOUT,\n      header: {\n        'content-type': options.contentType || 'application/json',\n        ...options.header\n      },\n      data: options.data || {},\n      success: (res) => {\n        // 处理响应\n        console.log(res)\n        handleResponse(res, resolve, reject);\n      },\n      fail: (err) => {\n        // 处理失败\n        handleRequestError(err, reject);\n      }\n    };\n\n    // 添加token（如果有）\n    const token = getToken();\n    if (token) {\n      config.header['Authorization'] = `Bearer ${token}`;\n    }\n\n    // 发送请求\n    uni.request(config);\n  });\n}\n\n// 处理响应\nfunction handleResponse(res, resolve, reject) {\n  const { statusCode, data } = res;\n\n  // 处理HTTP状态码\n  if (statusCode === 200) {\n    // 处理业务逻辑\n    if (data.code === 200) {\n      // 请求成功\n      resolve(data);\n    } else if (data.code === 401) {\n      // Token过期或无效\n      clearToken();\n      uni.navigateTo({ url: '/pages/login/login' });\n      reject(new Error('登录已过期，请重新登录'));\n    } else {\n      // 业务错误\n      uni.showToast({\n        title: data.msg || '请求失败',\n        icon: 'none'\n      });\n      reject(new Error(data.msg || '业务处理失败'));\n    }\n  } else if (statusCode === 401) {\n    // Token过期或无效\n    clearToken();\n    uni.navigateTo({ url: '/pages/login/login' });\n    reject(new Error('登录已过期，请重新登录'));\n  } else if (statusCode === 403) {\n    uni.showToast({\n      title: '没有权限访问',\n      icon: 'none'\n    });\n    reject(new Error('权限不足'));\n  } else if (statusCode === 404) {\n    uni.showToast({\n      title: '请求的资源不存在',\n      icon: 'none'\n    });\n    reject(new Error('资源不存在'));\n  } else if (statusCode === 500) {\n    uni.showToast({\n      title: '服务器内部错误',\n      icon: 'none'\n    });\n    reject(new Error('服务器错误'));\n  } else {\n    uni.showToast({\n      title: `请求失败: ${statusCode}`,\n      icon: 'none'\n    });\n    reject(new Error(`HTTP错误: ${statusCode}`));\n  }\n}\n\n// 处理请求失败\nfunction handleRequestError(err, reject) {\n  // 网络错误处理\n  uni.showToast({\n    title: '网络连接失败，请检查网络设置',\n    icon: 'none'\n  });\n  console.error('请求失败:', err);\n  reject(new Error('网络连接失败'));\n}\n\n// 导出常用请求方法\nconst http = {\n  get: (url, data = {}, options = {}) => {\n    return request({ url, method: 'GET', data, ...options });\n  },\n  post: (url, data = {}, options = {}) => {\n    return request({ url, method: 'POST', data, ...options });\n  },\n  put: (url, data = {}, options = {}) => {\n    return request({ url, method: 'PUT', data, ...options });\n  },\n  delete: (url, data = {}, options = {}) => {\n    return request({ url, method: 'DELETE', data, ...options });\n  }\n};\n\n// 导出工具函数\nexport {\n  http,\n  getToken,\n  setToken,\n  clearToken,\n  isLoggedIn\n};\n\nexport default http;"],"mappings":"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","ignoreList":[]}