{"version":3,"file":"app.js","sources":["App.vue","main.js"],"sourcesContent":["<!--\n * @Author: delin66\n * @Date: 2025-11-14 20:28:38\n * @LastEditors: delin66\n * @LastEditTime: 2025-11-17 21:22:33\n * @Descripttion: \n-->\n<script>\n// 导入存储相关的工具方法\nimport { getToken } from \"./utils/storage\";\n\nexport default {\n  onLaunch: function () {\n    console.log(\"App Launch\");\n    // 初始化全局路由守卫\n    this.initRouterGuard();\n  },\n  onShow: function () {\n    console.log(\"App Show\");\n  },\n  onHide: function () {\n    console.log(\"App Hide\");\n  },\n  methods: {\n    initRouterGuard() {\n      // 使用uni-app的路由钩子\n      const that = this;\n      // 路由前置守卫\n      uni.addInterceptor(\"navigateTo\", {\n        invoke(e) {\n          return that.checkPermission(e.url);\n        },\n        error(err) {\n          console.error(\"导航错误:\", err);\n        },\n      });\n\n      // 拦截reLaunch，处理tab切换和页面跳转\n      uni.addInterceptor(\"reLaunch\", {\n        invoke(e) {\n          return that.checkPermission(e.url);\n        },\n      });\n\n      // 拦截redirectTo\n      uni.addInterceptor(\"redirectTo\", {\n        invoke(e) {\n          return that.checkPermission(e.url);\n        },\n      });\n    },\n\n    // 检查访问权限\n    checkPermission(url) {\n      // 不需要登录的页面列表\n      const whiteList = [\"/pages/login/login\", \"/pages/register/register\"];\n\n      // 解析url，获取页面路径（去掉参数部分）\n      let path = url;\n      if (url.indexOf(\"?\") !== -1) {\n        path = url.split(\"?\")[0];\n      }\n\n      // 检查是否在白名单中\n      if (whiteList.includes(path)) {\n        return true;\n      }\n\n      // 获取token\n      const token = getToken();\n\n      // 如果没有token，重定向到登录页面\n      if (!token) {\n        // 避免无限重定向\n        if (path !== \"/pages/login/login\") {\n          console.log(\"未登录，重定向到登录页面\");\n          uni.reLaunch({\n            url: \"/pages/login/login\",\n          });\n          return false;\n        }\n      }\n\n      return true;\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n/*每个页面公共css */\n@import '@/uni_modules/uni-scss/index.scss';\n\nbody {\n  height: 100%;\n}\n</style>\n","/*\n * @Author: delin66\n * @Date: 2025-11-14 20:28:38\n * @LastEditors: delin66\n * @LastEditTime: 2025-12-16 19:21:23\n * @Descripttion: \n */\nimport App from './App'\n\n// #ifndef VUE3\nimport Vue from 'vue'\nimport './uni.promisify.adaptor'\nVue.config.productionTip = false\nApp.mpType = 'app'\nconst app = new Vue({\n  ...App\n})\napp.$mount()\n// #endif\n\n// #ifdef VUE3\nimport { createSSRApp } from 'vue'\nexport function createApp() {\n  const app = createSSRApp(App)\n  return {\n    app\n  }\n}\n// #endif"],"names":["uni","getToken","createSSRApp","App"],"mappings":";;;;;;;;;;;;;;;;;AAWA,MAAK,YAAU;AAAA,EACb,UAAU,WAAY;AACpBA,kBAAAA,MAAY,MAAA,OAAA,iBAAA,YAAY;AAExB,SAAK,gBAAe;AAAA,EACrB;AAAA,EACD,QAAQ,WAAY;AAClBA,kBAAAA,MAAA,MAAA,OAAA,iBAAY,UAAU;AAAA,EACvB;AAAA,EACD,QAAQ,WAAY;AAClBA,kBAAAA,MAAA,MAAA,OAAA,iBAAY,UAAU;AAAA,EACvB;AAAA,EACD,SAAS;AAAA,IACP,kBAAkB;AAEhB,YAAM,OAAO;AAEbA,oBAAG,MAAC,eAAe,cAAc;AAAA,QAC/B,OAAO,GAAG;AACR,iBAAO,KAAK,gBAAgB,EAAE,GAAG;AAAA,QAClC;AAAA,QACD,MAAM,KAAK;AACTA,wBAAc,MAAA,MAAA,SAAA,iBAAA,SAAS,GAAG;AAAA,QAC3B;AAAA,MACH,CAAC;AAGDA,oBAAG,MAAC,eAAe,YAAY;AAAA,QAC7B,OAAO,GAAG;AACR,iBAAO,KAAK,gBAAgB,EAAE,GAAG;AAAA,QAClC;AAAA,MACH,CAAC;AAGDA,oBAAG,MAAC,eAAe,cAAc;AAAA,QAC/B,OAAO,GAAG;AACR,iBAAO,KAAK,gBAAgB,EAAE,GAAG;AAAA,QAClC;AAAA,MACH,CAAC;AAAA,IACF;AAAA;AAAA,IAGD,gBAAgB,KAAK;AAEnB,YAAM,YAAY,CAAC,sBAAsB,0BAA0B;AAGnE,UAAI,OAAO;AACX,UAAI,IAAI,QAAQ,GAAG,MAAM,IAAI;AAC3B,eAAO,IAAI,MAAM,GAAG,EAAE,CAAC;AAAA,MACzB;AAGA,UAAI,UAAU,SAAS,IAAI,GAAG;AAC5B,eAAO;AAAA,MACT;AAGA,YAAM,QAAQC,cAAAA;AAGd,UAAI,CAAC,OAAO;AAEV,YAAI,SAAS,sBAAsB;AACjCD,wBAAAA,MAAA,MAAA,OAAA,iBAAY,cAAc;AAC1BA,wBAAAA,MAAI,SAAS;AAAA,YACX,KAAK;AAAA,UACP,CAAC;AACD,iBAAO;AAAA,QACT;AAAA,MACF;AAEA,aAAO;AAAA,IACR;AAAA,EACF;AACH;AChEO,SAAS,YAAY;AAC1B,QAAM,MAAME,cAAY,aAACC,SAAG;AAC5B,SAAO;AAAA,IACL;AAAA,EACD;AACH;;;"}