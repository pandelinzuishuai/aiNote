{"version":3,"file":"task.js","sources":["api/task.js"],"sourcesContent":["// 任务相关接口函数\n\nimport { http } from '../utils/request';\n\n/**\n * 获取任务列表\n * @param {Object} taskQuery - 任务查询参数\n * @param {number} [taskQuery.currentPage] - 当前页码（可选）\n * @param {number} [taskQuery.pageSize] - 每页数量（可选）\n * @param {number} [taskQuery.userId] - 用户ID（可选）\n * @param {number} [taskQuery.subjectId] - 主题ID（可选）\n * @param {string} [taskQuery.taskName] - 任务名称（可选）\n * @param {string} [taskQuery.priority] - 优先级（可选）\n * @param {string} [taskQuery.status] - 状态（可选）\n * @returns {Promise} 返回任务列表\n */\nexport async function getTaskList(taskQuery = {}) {\n  try {\n    const defaultQuery = {\n      currentPage: 1,\n      pageSize: 10\n    };\n    const query = { ...defaultQuery, ...taskQuery };\n    // 根据API文档，修改为POST请求，参数放在body中\n    const res = await http.post('/task/list', query, { needLogin: true });\n    return res;\n  } catch (error) {\n    console.error('获取任务列表失败:', error);\n    throw error;\n  }\n}\n\n/**\n * 获取任务信息\n * @param {number} id - 任务ID\n * @returns {Promise} 返回任务详情\n */\nexport async function getTaskInfo(id) {\n  try {\n    const res = await http.get(`/task/getInfo?id=${encodeURIComponent(id)}`, {}, { needLogin: true });\n    return res;\n  } catch (error) {\n    console.error('获取任务信息失败:', error);\n    throw error;\n  }\n}\n\n/**\n * 添加任务\n * @param {Object} addTaskForm - 添加任务表单数据\n * @param {number} addTaskForm.userId - 用户ID\n * @param {number} [addTaskForm.subjectId] - 主题ID（可选）\n * @param {string} addTaskForm.taskName - 任务名称\n * @param {string} [addTaskForm.description] - 任务描述（可选）\n * @param {string} [addTaskForm.deadline] - 截止时间（可选）\n * @param {string} [addTaskForm.priority] - 优先级（可选）\n * @returns {Promise} 返回添加结果\n */\nexport async function addTask(addTaskForm) {\n  try {\n    const res = await http.post('/task/add', addTaskForm, { needLogin: true });\n    return res;\n  } catch (error) {\n    console.error('添加任务失败:', error);\n    throw error;\n  }\n}\n\n/**\n * 更新任务信息\n * @param {Object} updateTaskForm - 更新任务表单数据\n * @param {number} updateTaskForm.taskId - 任务ID\n * @param {string} [updateTaskForm.taskName] - 任务名称（可选）\n * @param {string} [updateTaskForm.description] - 任务描述（可选）\n * @param {string} [updateTaskForm.deadline] - 截止时间（可选）\n * @param {string} [updateTaskForm.priority] - 优先级（可选）\n * @param {string} [updateTaskForm.status] - 状态（可选）\n * @param {string} [updateTaskForm.finishTime] - 完成时间（可选）\n * @returns {Promise} 返回更新结果\n */\nexport async function updateTask(updateTaskForm) {\n  try {\n    const res = await http.put('/task/update', updateTaskForm, { needLogin: true });\n    return res;\n  } catch (error) {\n    console.error('更新任务失败:', error);\n    throw error;\n  }\n}\n\n/**\n * 删除任务\n * @param {number} id - 任务ID\n * @returns {Promise} 返回删除结果\n */\nexport async function deleteTask(id) {\n  try {\n    const res = await http.delete(`/task/delete?id=${encodeURIComponent(id)}`, {}, { needLogin: true });\n    return res;\n  } catch (error) {\n    console.error('删除任务失败:', error);\n    throw error;\n  }\n}\n\n/**\n * 批量获取任务信息\n * @param {Array<number>} ids - 任务ID数组\n * @returns {Promise} 返回任务列表\n */\nexport async function getTasksByIds(ids) {\n  try {\n    // 这里假设后端有批量获取任务的接口，如果没有，可以通过循环调用getTaskInfo实现\n    const tasks = await Promise.all(ids.map(id => getTaskInfo(id)));\n    return {\n      code: 0,\n      msg: 'success',\n      data: tasks.map(task => task.data)\n    };\n  } catch (error) {\n    console.error('批量获取任务失败:', error);\n    throw error;\n  }\n}\n\n/**\n * 更新任务状态\n * @param {number} taskId - 任务ID\n * @param {string} status - 新状态\n * @returns {Promise} 返回更新结果\n */\nexport async function updateTaskStatus(taskId, status) {\n  try {\n    const res = await updateTask({\n      taskId,\n      status,\n      // 如果状态是已完成，自动设置完成时间\n      finishTime: status === '已完成' ? new Date().toISOString() : undefined\n    });\n    return res;\n  } catch (error) {\n    console.error('更新任务状态失败:', error);\n    throw error;\n  }\n}\n\n/**\n * 获取任务统计信息\n * @param {number} userId - 用户ID\n * @returns {Promise} 返回统计结果\n */\nexport async function getTaskStatistics(userId) {\n  try {\n    // 这里假设后端有统计接口，如果没有，可以通过获取任务列表后本地计算\n    const taskList = await getTaskList({ userId });\n    if (taskList.code === 0 && taskList.data) {\n      const tasks = taskList.data.list || [];\n      const statistics = {\n        total: tasks.length,\n        pending: tasks.filter(task => task.status === 'pending').length,\n        inProgress: tasks.filter(task => task.status === 'in_progress').length,\n        completed: tasks.filter(task => task.status === 'completed').length,\n        overdue: tasks.filter(task => {\n          return task.status !== 'completed' && task.deadline && new Date(task.deadline) < new Date();\n        }).length\n      };\n      return {\n        code: 0,\n        msg: 'success',\n        data: statistics\n      };\n    }\n    throw new Error('获取任务列表失败');\n  } catch (error) {\n    console.error('获取任务统计失败:', error);\n    throw error;\n  }\n}"],"names":["http","uni"],"mappings":"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"}