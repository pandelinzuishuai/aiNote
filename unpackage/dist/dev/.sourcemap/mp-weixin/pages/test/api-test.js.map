{"version":3,"file":"api-test.js","sources":["pages/test/api-test.vue","../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdGVzdC9hcGktdGVzdC52dWU"],"sourcesContent":["<template>\n  <view class=\"api-test-container\">\n    <view class=\"header\">\n      <text class=\"title\">API接口测试</text>\n    </view>\n    \n    <view class=\"test-section\">\n      <text class=\"section-title\">Token状态</text>\n      <view class=\"status-info\">\n        <text v-if=\"tokenStatus.hasToken\" class=\"status-success\">✓ 已登录</text>\n        <text v-else class=\"status-error\">✗ 未登录</text>\n        <text class=\"token-text\">{{ tokenStatus.token || '无' }}</text>\n      </view>\n    </view>\n    \n    <view class=\"test-section\">\n      <text class=\"section-title\">用户相关测试</text>\n      <button class=\"test-btn\" @click=\"handleLogin\">模拟登录</button>\n      <button class=\"test-btn\" @click=\"handleGetUserInfo\">获取用户信息</button>\n      <button class=\"test-btn\" @click=\"handleLogout\">退出登录</button>\n    </view>\n    \n    <view class=\"test-section\">\n      <text class=\"section-title\">任务相关测试</text>\n      <button class=\"test-btn\" @click=\"handleGetTaskList\">获取任务列表</button>\n      <button class=\"test-btn\" @click=\"handleGetTaskInfo\">获取任务详情</button>\n    </view>\n    \n    <view class=\"test-section\">\n      <text class=\"section-title\">综合测试</text>\n      <button class=\"test-btn primary\" @click=\"handleRunAllTests\">运行全部测试</button>\n    </view>\n    \n    <view class=\"log-section\">\n      <text class=\"section-title\">测试日志</text>\n      <scroll-view class=\"log-content\" scroll-y=\"true\">\n        <text v-for=\"(log, index) in logs\" :key=\"index\" class=\"log-item\">{{ log }}</text>\n      </scroll-view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { mockAPI, runAPITests } from '../../utils/api.test';\n\nexport default {\n  data() {\n    return {\n      tokenStatus: {\n        hasToken: false,\n        token: ''\n      },\n      logs: []\n    };\n  },\n  onLoad() {\n    this.updateTokenStatus();\n    this.log('API测试页面已加载');\n  },\n  methods: {\n    // 更新token状态\n    updateTokenStatus() {\n      const token = uni.getStorageSync('token');\n      this.tokenStatus = {\n        hasToken: !!token,\n        token: token || ''\n      };\n    },\n    \n    // 记录日志\n    log(message) {\n      const timestamp = new Date().toLocaleTimeString();\n      this.logs.push(`[${timestamp}] ${message}`);\n      // 保持日志在最新状态\n      setTimeout(() => {\n        const logContent = this.$refs.logContent;\n        if (logContent) {\n          logContent.scrollToEnd();\n        }\n      }, 100);\n    },\n    \n    // 模拟登录\n    async handleLogin() {\n      this.log('开始模拟登录...');\n      try {\n        const result = await mockAPI.mockLogin();\n        this.log('登录成功:', result.msg);\n        this.updateTokenStatus();\n        uni.showToast({\n          title: '登录成功',\n          icon: 'success'\n        });\n      } catch (error) {\n        this.log('登录失败:', error.message);\n        uni.showToast({\n          title: '登录失败',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 获取用户信息\n    async handleGetUserInfo() {\n      this.log('开始获取用户信息...');\n      try {\n        const result = await mockAPI.mockGetUserInfo();\n        if (result.code === 0) {\n          this.log('获取用户信息成功:', result.data.username);\n          uni.showToast({\n            title: '获取成功',\n            icon: 'success'\n          });\n        } else {\n          this.log('获取用户信息失败:', result.msg);\n          uni.showToast({\n            title: result.msg,\n            icon: 'none'\n          });\n        }\n      } catch (error) {\n        this.log('获取用户信息失败:', error.message);\n        uni.showToast({\n          title: '获取失败',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 退出登录\n    handleLogout() {\n      this.log('开始退出登录...');\n      try {\n        mockAPI.mockLogout();\n        this.log('退出登录成功');\n        this.updateTokenStatus();\n        uni.showToast({\n          title: '退出成功',\n          icon: 'success'\n        });\n      } catch (error) {\n        this.log('退出登录失败:', error.message);\n        uni.showToast({\n          title: '退出失败',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 获取任务列表\n    async handleGetTaskList() {\n      this.log('开始获取任务列表...');\n      try {\n        const result = await mockAPI.mockGetTaskList();\n        if (result.code === 0) {\n          this.log(`获取任务列表成功，共${result.data.total}条记录`);\n          uni.showToast({\n            title: '获取成功',\n            icon: 'success'\n          });\n        } else {\n          this.log('获取任务列表失败:', result.msg);\n          uni.showToast({\n            title: result.msg,\n            icon: 'none'\n          });\n        }\n      } catch (error) {\n        this.log('获取任务列表失败:', error.message);\n        uni.showToast({\n          title: '获取失败',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 获取任务详情\n    async handleGetTaskInfo() {\n      this.log('开始获取任务详情...');\n      try {\n        const result = await mockAPI.mockGetTaskInfo(1);\n        if (result.code === 0) {\n          this.log('获取任务详情成功:', result.data.taskName);\n          uni.showToast({\n            title: '获取成功',\n            icon: 'success'\n          });\n        } else {\n          this.log('获取任务详情失败:', result.msg);\n          uni.showToast({\n            title: result.msg,\n            icon: 'none'\n          });\n        }\n      } catch (error) {\n        this.log('获取任务详情失败:', error.message);\n        uni.showToast({\n          title: '获取失败',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 运行全部测试\n    async handleRunAllTests() {\n      this.log('开始运行全部API测试...');\n      this.log('==================================');\n      \n      // 清空之前的日志\n      this.logs = ['[开始运行全部API测试]'];\n      \n      try {\n        const result = await runAPITests();\n        \n        if (result.success) {\n          this.log('测试完成: 所有测试通过!');\n          this.updateTokenStatus();\n          uni.showToast({\n            title: '测试全部通过',\n            icon: 'success'\n          });\n        } else {\n          this.log('测试失败:', result.error);\n          uni.showToast({\n            title: '测试失败',\n            icon: 'none'\n          });\n        }\n      } catch (error) {\n        this.log('测试过程中发生错误:', error.message);\n        uni.showToast({\n          title: '测试异常',\n          icon: 'none'\n        });\n      } finally {\n        this.log('==================================');\n        this.log('API测试运行结束');\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n.api-test-container {\n  padding: 20rpx;\n  background-color: #f5f5f5;\n  min-height: 100vh;\n}\n\n.header {\n  text-align: center;\n  margin-bottom: 30rpx;\n}\n\n.title {\n  font-size: 48rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.test-section {\n  background-color: #fff;\n  border-radius: 12rpx;\n  padding: 30rpx;\n  margin-bottom: 30rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\n}\n\n.section-title {\n  font-size: 36rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 20rpx;\n  display: block;\n}\n\n.status-info {\n  padding: 20rpx;\n  background-color: #f0f0f0;\n  border-radius: 8rpx;\n  margin-bottom: 20rpx;\n}\n\n.status-success {\n  color: #07c160;\n  font-weight: bold;\n}\n\n.status-error {\n  color: #e64340;\n  font-weight: bold;\n}\n\n.token-text {\n  font-size: 24rpx;\n  color: #666;\n  display: block;\n  margin-top: 10rpx;\n  word-break: break-all;\n}\n\n.test-btn {\n  width: 100%;\n  margin-bottom: 20rpx;\n  background-color: #fff;\n  color: #333;\n  border: 1rpx solid #ddd;\n}\n\n.test-btn.primary {\n  background-color: #4a6cf7;\n  color: #fff;\n  border: none;\n}\n\n.log-section {\n  background-color: #fff;\n  border-radius: 12rpx;\n  padding: 30rpx;\n  margin-bottom: 30rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.1);\n}\n\n.log-content {\n  height: 400rpx;\n  background-color: #f8f8f8;\n  border-radius: 8rpx;\n  padding: 20rpx;\n  font-size: 28rpx;\n}\n\n.log-item {\n  display: block;\n  margin-bottom: 10rpx;\n  color: #666;\n  word-break: break-all;\n  white-space: pre-wrap;\n}\n</style>","import MiniProgramPage from 'D:/programming/Uniapp/aiNote/pages/test/api-test.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","mockAPI","runAPITests"],"mappings":"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"}