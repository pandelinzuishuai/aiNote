{"version":3,"file":"register.js","sources":["pages/register/register.vue","../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcmVnaXN0ZXIvcmVnaXN0ZXIudnVl"],"sourcesContent":["<template>\n  <view class=\"register-container\">\n    <view class=\"register-header\">\n      <view class=\"back-btn\" @click=\"goBack\">\n        <text class=\"back-icon\"></text>\n      </view>\n      <text class=\"page-title\">创建账户</text>\n    </view>\n    \n    <scroll-view scroll-y=\"true\" class=\"register-content\">\n      <view class=\"register-form\">\n        <view class=\"form-group\">\n          <text class=\"form-label\">姓名</text>\n          <input \n            class=\"form-input\" \n            type=\"text\" \n            v-model=\"registerForm.name\"\n            placeholder=\"输入您的姓名\"\n            placeholder-style=\"color: #999\"\n          />\n        </view>\n        <view class=\"form-group\">\n          <text class=\"form-label\">电子邮箱</text>\n          <input \n            class=\"form-input\" \n            type=\"text\" \n            v-model=\"registerForm.email\"\n            placeholder=\"输入您的邮箱\"\n            placeholder-style=\"color: #999\"\n          />\n        </view>\n        <view class=\"form-group\">\n          <text class=\"form-label\">验证码</text>\n          <view class=\"verification-code-container\">\n            <input \n              class=\"form-input verification-input\" \n              type=\"text\" \n              v-model=\"registerForm.code\"\n              placeholder=\"输入验证码\"\n              placeholder-style=\"color: #999\"\n            />\n            <button \n              class=\"send-code-btn\" \n              @click=\"sendcode\" \n              :disabled=\"countdown > 0\"\n            >\n              {{ countdown > 0 ? `${countdown}秒后重试` : '发送验证码' }}\n            </button>\n          </view>\n        </view>\n        <view class=\"form-group\">\n          <text class=\"form-label\">密码</text>\n          <input \n            class=\"form-input\" \n            type=\"password\" \n            v-model=\"registerForm.password\"\n            placeholder=\"设置您的密码（至少6位）\"\n            placeholder-style=\"color: #999\"\n          />\n          <view v-if=\"registerForm.password\" class=\"password-strength\">\n            <view class=\"strength-item\" :class=\"{ 'strength-weak': getPasswordStrength(registerForm.password) >= 1 }\"></view>\n            <view class=\"strength-item\" :class=\"{ 'strength-medium': getPasswordStrength(registerForm.password) >= 3 }\"></view>\n            <view class=\"strength-item\" :class=\"{ 'strength-strong': getPasswordStrength(registerForm.password) >= 5 }\"></view>\n          </view>\n        </view>\n        <view class=\"form-group\">\n          <text class=\"form-label\">确认密码</text>\n          <input \n            class=\"form-input\" \n            type=\"password\" \n            v-model=\"registerForm.confirmPassword\"\n            placeholder=\"再次输入密码\"\n            placeholder-style=\"color: #999\"\n          />\n        </view>\n        <view class=\"agreement-container\">\n          <checkbox :checked=\"isAgreed\" class=\"agreement-checkbox\" @change=\"handleAgreementChange\"></checkbox>\n          <text class=\"agreement-text\">\n            我同意<text class=\"agreement-link\" @click=\"viewTerms\">服务条款</text>和<text class=\"agreement-link\" @click=\"viewPrivacy\">隐私政策</text>\n          </text>\n        </view>\n        <button class=\"register-btn\" @click=\"handleRegister\">注册账号</button>\n        <view class=\"login-link\">\n          已有账号？<text @click=\"goToLogin\" class=\"link-text\">返回登录</text>\n        </view>\n      </view>\n    </scroll-view>\n  </view>\n</template>\n\n<script>\nimport { userAPI } from '../../api';\n\nexport default {\n  data() {\n    return {\n      registerForm: {\n        name: '',\n        email: '',\n        code: '',\n        password: '',\n        confirmPassword: ''\n      },\n      countdown: 0,\n      timer: null,\n      isAgreed: true,\n      isLoading: false,\n      isSendingCode: false\n    }\n  },\n  onUnload() {\n    // 清理定时器\n    if (this.timer) {\n      clearInterval(this.timer);\n      this.timer = null;\n    }\n  },\n  methods: {\n    goBack() {\n      uni.navigateBack();\n    },\n    \n    // 验证邮箱格式\n    validateEmail(email) {\n      const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n      return emailRegex.test(email);\n    },\n    \n    // 发送验证码\n    async sendcode() {\n      // 验证邮箱\n      if (!this.registerForm.email) {\n        uni.showToast({\n          title: '请输入邮箱地址',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      if (!this.validateEmail(this.registerForm.email)) {\n        uni.showToast({\n          title: '请输入有效的邮箱地址',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      try {\n        this.isSendingCode = true;\n        console.log(this.registerForm.email)\n        // 调用发送验证码API\n        const result = await userAPI.sendEmailCode(this.registerForm.email);\n        \n        \n        if (result.code === 0) {\n          // 开始倒计时\n          this.startCountdown();\n          \n          uni.showToast({\n            title: result.msg || '验证码已发送',\n            icon: 'success'\n          });\n        } else {\n          uni.showToast({\n            title: result.msg || '发送验证码失败',\n            icon: 'none'\n          });\n        }\n      } catch (error) {\n        console.error('发送验证码错误:', error);\n        uni.showToast({\n          title: error.message || '网络错误，请稍后重试',\n          icon: 'none'\n        });\n      } finally {\n        this.isSendingCode = false;\n      }\n    },\n    \n    // 开始倒计时\n    startCountdown() {\n      this.countdown = 60;\n      \n      if (this.timer) {\n        clearInterval(this.timer);\n      }\n      \n      this.timer = setInterval(() => {\n        this.countdown--;\n        if (this.countdown <= 0) {\n          clearInterval(this.timer);\n          this.timer = null;\n        }\n      }, 1000);\n    },\n    \n    // 密码强度检查\n    getPasswordStrength(password) {\n      if (!password) return 0;\n      let strength = 0;\n      // 长度检查\n      if (password.length >= 8) strength++;\n      // 包含数字\n      if (password.match(/[0-9]/)) strength++;\n      // 包含小写字母\n      if (password.match(/[a-z]/)) strength++;\n      // 包含大写字母\n      if (password.match(/[A-Z]/)) strength++;\n      // 包含特殊字符\n      if (password.match(/[!@#$%^&*(),.?\":{}|<>]/)) strength++;\n      return strength;\n    },\n    \n    // 处理注册\n    async handleRegister() {\n      // 表单验证\n      if (!this.registerForm.name) {\n        uni.showToast({\n          title: '请输入姓名',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      if (!this.registerForm.email) {\n        uni.showToast({\n          title: '请输入邮箱',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      if (!this.validateEmail(this.registerForm.email)) {\n        uni.showToast({\n          title: '请输入有效的邮箱地址',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      if (!this.registerForm.code) {\n        uni.showToast({\n          title: '请输入验证码',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      if (this.registerForm.code.length < 4) {\n        uni.showToast({\n          title: '请输入有效的验证码',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      if (!this.registerForm.password) {\n        uni.showToast({\n          title: '请设置密码',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      if (this.registerForm.password.length < 6) {\n        uni.showToast({\n          title: '密码长度不能少于6位',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      if (this.registerForm.password !== this.registerForm.confirmPassword) {\n        uni.showToast({\n          title: '两次输入的密码不一致',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      if (!this.isAgreed) {\n        uni.showToast({\n          title: '请同意服务条款和隐私政策',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      try {\n        this.isLoading = true;\n        \n        // 调用注册API\n        const result = await userAPI.register({\n          username: this.registerForm.name,\n          email: this.registerForm.email,\n          code: this.registerForm.code,\n          password: this.registerForm.password,\n          permId:1 \n        });\n        \n        if (result.code === 200) {\n          uni.showToast({\n            title: result.msg || '注册成功',\n            icon: 'success'\n          });\n          \n          setTimeout(() => {\n            // 注册成功后跳转到登录页\n            uni.navigateTo({\n              url: '/pages/login/login'\n            });\n          }, 1500);\n        } else {\n          uni.showToast({\n            title: result.msg || '注册失败',\n            icon: 'none'\n          });\n        }\n      } catch (error) {\n        console.error('注册错误:', error);\n        uni.showToast({\n          title: error.message || '网络错误，请稍后重试',\n          icon: 'none'\n        });\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    \n    // 处理协议勾选变化\n    handleAgreementChange(e) {\n      this.isAgreed = e.target.checked;\n    },\n    \n    goToLogin() {\n      uni.navigateTo({\n        url: '/pages/login/login'\n      });\n    },\n    \n    // 查看服务条款\n    viewTerms() {\n      uni.showToast({\n        title: '服务条款功能开发中',\n        icon: 'none'\n      });\n    },\n    \n    // 查看隐私政策\n    viewPrivacy() {\n      uni.showToast({\n        title: '隐私政策功能开发中',\n        icon: 'none'\n      });\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.register-container {\n  min-height: 100vh;\n  background-color: #ffffff;\n  display: flex;\n  flex-direction: column;\n}\n\n.register-header {\n  display: flex;\n  align-items: center;\n  padding: 40rpx 30rpx;\n  border-bottom: 1rpx solid #f0f0f0;\n  \n  .back-btn {\n    width: 80rpx;\n    height: 80rpx;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    margin-right: 40rpx;\n    \n    .back-icon {\n      font-size: 40rpx;\n      color: #333;\n      position: relative;\n      &::before {\n        content: '';\n        position: absolute;\n        width: 20rpx;\n        height: 20rpx;\n        border-left: 3rpx solid #333;\n        border-top: 3rpx solid #333;\n        transform: rotate(-45deg);\n      }\n    }\n  }\n  \n  .page-title {\n    font-size: 36rpx;\n    font-weight: 600;\n    color: #333333;\n    flex: 1;\n  }\n}\n\n.register-content {\n  width: auto;\n  flex: 1;\n  padding: 40rpx 30rpx;\n  overflow-y: auto;\n}\n\n.register-form {\n  \n  .form-group {\n    margin-bottom: 36rpx;\n    \n    .form-label {\n      display: block;\n      font-size: 28rpx;\n      color: #333333;\n      margin-bottom: 12rpx;\n      font-weight: 500;\n    }\n    \n    .form-input {\n      width: 100%;\n      height: 88rpx;\n      border: 2rpx solid #e0e0e0;\n      border-radius: 16rpx;\n      padding: 0 30rpx;\n      font-size: 30rpx;\n      color: #333;\n      background: #ffffff;\n      box-sizing: border-box;\n      \n      &:focus {\n        border-color: #5374f7;\n      }\n    }\n  }\n  \n  .verification-code-container {\n    display: flex;\n    gap: 20rpx;\n    \n    .verification-input {\n      flex: 1;\n    }\n    \n    .send-code-btn {\n      width: 220rpx;\n      height: 88rpx;\n      background-color: #5374f7;\n      color: #ffffff;\n      border: none;\n      border-radius: 16rpx;\n      font-size: 26rpx;\n      \n      &:disabled {\n        background-color: #aabaf7;\n      }\n    }\n  }\n  \n  .agreement-container {\n    display: flex;\n    align-items: center;\n    margin-bottom: 40rpx;\n    \n    .agreement-checkbox {\n      transform: scale(0.8);\n      margin-right: 8rpx;\n    }\n    \n    .agreement-text {\n      font-size: 26rpx;\n      color: #666;\n      \n      .agreement-link {\n        color: #5374f7;\n      }\n    }\n  }\n  \n  .register-btn {\n        width: 100%;\n        height: 88rpx;\n        background-color: #5374f7;\n        color: #ffffff;\n        border: none;\n        border-radius: 16rpx;\n        font-size: 32rpx;\n        font-weight: 600;\n        margin-bottom: 30rpx;\n      }\n      \n      .password-strength {\n        display: flex;\n        gap: 8rpx;\n        margin-top: 10rpx;\n        \n        .strength-item {\n          flex: 1;\n          height: 6rpx;\n          background-color: #e0e0e0;\n          border-radius: 3rpx;\n        }\n        \n        .strength-weak {\n          background-color: #ff6b6b;\n        }\n        \n        .strength-medium {\n          background-color: #ffd93d;\n        }\n        \n        .strength-strong {\n          background-color: #6bcb77;\n        }\n      }\n  \n  .login-link {\n    text-align: center;\n    font-size: 28rpx;\n    color: #666;\n    \n    .link-text {\n      color: #5374f7;\n    }\n  }\n}\n</style>","import MiniProgramPage from 'D:/programming/Uniapp/aiNote/pages/register/register.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","userAPI"],"mappings":"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"}