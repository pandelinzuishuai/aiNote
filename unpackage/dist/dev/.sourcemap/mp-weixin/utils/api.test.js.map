{"version":3,"file":"api.test.js","sources":["utils/api.test.js"],"sourcesContent":["// API测试工具文件\n// 用于测试API接口调用和token校验功能\n\nimport { API, userAPI, taskAPI } from '../api';\n\n// 模拟数据\nconst mockData = {\n  // 模拟用户数据\n  user: {\n    loginSuccess: {\n      code: 0,\n      msg: '登录成功',\n      data: {\n        token: 'mock_token_123456',\n        userInfo: {\n          id: 1,\n          username: 'testuser',\n          name: '测试用户',\n          email: 'test@example.com',\n          avatar: ''\n        }\n      }\n    },\n    registerSuccess: {\n      code: 0,\n      msg: '注册成功'\n    },\n    userInfo: {\n      code: 0,\n      msg: '获取成功',\n      data: {\n        id: 1,\n        username: 'testuser',\n        name: '测试用户',\n        email: 'test@example.com',\n        phone: '13800138000',\n        avatar: '',\n        count: 0\n      }\n    }\n  },\n  // 模拟任务数据\n  task: {\n    taskList: {\n      code: 0,\n      msg: '获取成功',\n      data: {\n        list: [\n          {\n            taskId: 1,\n            taskName: '学习Vue',\n            description: '学习Vue基础知识',\n            deadline: '2025-12-31 23:59:59',\n            priority: 'high',\n            status: 'pending',\n            userId: 1,\n            createTime: '2025-11-01 00:00:00'\n          },\n          {\n            taskId: 2,\n            taskName: '完成项目',\n            description: '完成项目开发',\n            deadline: '2025-12-15 23:59:59',\n            priority: 'medium',\n            status: 'in_progress',\n            userId: 1,\n            createTime: '2025-11-10 00:00:00'\n          }\n        ],\n        total: 2,\n        currentPage: 1,\n        pageSize: 10\n      }\n    },\n    taskInfo: {\n      code: 0,\n      msg: '获取成功',\n      data: {\n        taskId: 1,\n        taskName: '学习Vue',\n        description: '学习Vue基础知识',\n        deadline: '2025-12-31 23:59:59',\n        priority: 'high',\n        status: 'pending',\n        userId: 1,\n        createTime: '2025-11-01 00:00:00'\n      }\n    },\n    addSuccess: {\n      code: 0,\n      msg: '添加成功'\n    },\n    updateSuccess: {\n      code: 0,\n      msg: '更新成功'\n    },\n    deleteSuccess: {\n      code: 0,\n      msg: '删除成功'\n    }\n  }\n};\n\n// 模拟API调用（开发环境使用）\nexport const mockAPI = {\n  // 模拟用户登录\n  async mockLogin() {\n    console.log('【模拟API】登录测试');\n    // 模拟网络延迟\n    await new Promise(resolve => setTimeout(resolve, 500));\n    \n    // 模拟保存token\n    uni.setStorageSync('token', mockData.user.loginSuccess.data.token);\n    uni.setStorageSync('userInfo', mockData.user.loginSuccess.data.userInfo);\n    \n    console.log('登录成功，token已保存');\n    return mockData.user.loginSuccess;\n  },\n  \n  // 模拟获取用户信息\n  async mockGetUserInfo() {\n    console.log('【模拟API】获取用户信息测试');\n    // 模拟网络延迟\n    await new Promise(resolve => setTimeout(resolve, 300));\n    \n    const token = uni.getStorageSync('token');\n    if (!token) {\n      console.error('未登录，token不存在');\n      return {\n        code: 401,\n        msg: '未登录'\n      };\n    }\n    \n    return mockData.user.userInfo;\n  },\n  \n  // 模拟获取任务列表\n  async mockGetTaskList() {\n    console.log('【模拟API】获取任务列表测试');\n    // 模拟网络延迟\n    await new Promise(resolve => setTimeout(resolve, 400));\n    \n    const token = uni.getStorageSync('token');\n    if (!token) {\n      console.error('未登录，token不存在');\n      return {\n        code: 401,\n        msg: '未登录'\n      };\n    }\n    \n    return mockData.task.taskList;\n  },\n  \n  // 模拟获取任务详情\n  async mockGetTaskInfo(taskId) {\n    console.log(`【模拟API】获取任务详情测试，任务ID: ${taskId}`);\n    // 模拟网络延迟\n    await new Promise(resolve => setTimeout(resolve, 300));\n    \n    const token = uni.getStorageSync('token');\n    if (!token) {\n      console.error('未登录，token不存在');\n      return {\n        code: 401,\n        msg: '未登录'\n      };\n    }\n    \n    return mockData.task.taskInfo;\n  },\n  \n  // 模拟退出登录\n  mockLogout() {\n    console.log('【模拟API】退出登录测试');\n    uni.removeStorageSync('token');\n    uni.removeStorageSync('userInfo');\n    console.log('已清除token和用户信息');\n    return { success: true };\n  },\n  \n  // 测试token校验\n  testTokenValidation() {\n    console.log('【测试】Token校验功能测试');\n    const token = uni.getStorageSync('token');\n    console.log(`当前Token: ${token || '无'}`);\n    console.log(`登录状态: ${!!token}`);\n    return { hasToken: !!token, token };\n  }\n};\n\n// 综合测试函数\nexport async function runAPITests() {\n  console.log('\\n========== API接口测试开始 ==========\\n');\n  \n  try {\n    // 1. 测试未登录状态\n    console.log('测试1: 未登录状态下访问需要权限的接口');\n    mockAPI.mockLogout(); // 确保先退出登录\n    const beforeLoginTest = await mockAPI.mockGetUserInfo();\n    console.log('未登录测试结果:', beforeLoginTest);\n    \n    // 2. 测试登录功能\n    console.log('\\n测试2: 用户登录');\n    const loginResult = await mockAPI.mockLogin();\n    console.log('登录结果:', loginResult);\n    \n    // 3. 测试token校验\n    console.log('\\n测试3: Token校验');\n    const tokenStatus = mockAPI.testTokenValidation();\n    console.log('Token状态:', tokenStatus);\n    \n    // 4. 测试获取用户信息\n    console.log('\\n测试4: 获取用户信息');\n    const userInfoResult = await mockAPI.mockGetUserInfo();\n    console.log('用户信息结果:', userInfoResult);\n    \n    // 5. 测试获取任务列表\n    console.log('\\n测试5: 获取任务列表');\n    const taskListResult = await mockAPI.mockGetTaskList();\n    console.log('任务列表结果:', taskListResult);\n    \n    // 6. 测试获取任务详情\n    console.log('\\n测试6: 获取任务详情');\n    const taskInfoResult = await mockAPI.mockGetTaskInfo(1);\n    console.log('任务详情结果:', taskInfoResult);\n    \n    // 7. 测试退出登录\n    console.log('\\n测试7: 退出登录');\n    const logoutResult = mockAPI.mockLogout();\n    console.log('退出登录结果:', logoutResult);\n    \n    // 8. 测试退出后token是否清除\n    console.log('\\n测试8: 检查退出后token状态');\n    const afterLogoutStatus = mockAPI.testTokenValidation();\n    console.log('退出后Token状态:', afterLogoutStatus);\n    \n    console.log('\\n========== API接口测试完成 ==========');\n    return {\n      success: true,\n      message: 'API测试完成'\n    };\n  } catch (error) {\n    console.error('\\n测试过程中发生错误:', error);\n    console.log('\\n========== API接口测试失败 ==========');\n    return {\n      success: false,\n      message: '测试失败',\n      error: error.message\n    };\n  }\n}\n\n/**\n * 使用说明：\n * 1. 在开发环境中，可以导入并调用这些模拟函数进行测试\n * 2. 在App.vue或main.js中初始化调用runAPITests()进行综合测试\n * 3. 实际接口开发完成后，可以将mockAPI替换为真实API调用\n */\n\n// 导出工具函数\nexport default {\n  mockAPI,\n  runAPITests,\n  mockData\n};\n\n// 自动运行测试（仅在开发环境）\nif (process.env.NODE_ENV === 'development') {\n  console.log('开发环境自动运行API测试');\n  // 延迟执行，确保应用初始化完成\n  setTimeout(() => {\n    // runAPITests(); // 取消注释即可自动运行测试\n  }, 1000);\n}"],"names":["uni"],"mappings":"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"}